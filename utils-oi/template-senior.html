<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title></title>
<style type="text/css">
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.body_foreground > .bold,.bold > .body_foreground, body.body_foreground > pre > .bold { color: #FFFFFF; font-weight: normal; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi38-92 { color: #5400a8; }
.ansi38-198 { color: #d20054; }
.ansi38-97 { color: #542a7e; }
.ansi38-145 { color: #7e7e7e; }
.ansi38-152 { color: #7ea8a8; }
.ansi38-220 { color: #d2a800; }
.ansi38-224 { color: #d2a8a8; }
.ansi38-86 { color: #2ad2a8; }
.ansi38-229 { color: #d2d27e; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content">
<span id="line-0"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P1429/divide-and-conquer.cpp</span></span>
<span id="line-2"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-4"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-5"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-6"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-7"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-8"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-9"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-10"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-11"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-12"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-13"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-14"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-15"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-16"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-17"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-18"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-19"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-20"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-21"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-22"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-23"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-24"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-25"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-26"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-27"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-28"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-29"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-30"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-31"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-32"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-33"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-34"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-35"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-36"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-37"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-38"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-39"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-40"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-41"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-42"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-43"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-44"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">200010</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-45"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-46"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-47"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">point</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-48"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">double</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-49"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-50"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">operator&lt;</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> point </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-51"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220"> x </span><span class="ansi38-198">==</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> y </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-52"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-53"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-54"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-55"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">cmpy</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-56"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-57"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-97">sqr</span><span class="ansi38-220">(</span><span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> n </span><span class="ansi38-198">*</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-58"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-59"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-97">dis</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-60"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-97">sqrt</span><span class="ansi38-220">(</span><span class="ansi38-224">sqr</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">sqr</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-61"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-62"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-63"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-97">solve</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-64"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">==</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> inf</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-65"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-224">dis</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-66"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-67"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">double</span><span class="ansi38-220"> d </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-68"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-69"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-70"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-97">fabs</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">m</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> d</span><span class="ansi38-220">)</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">c</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-71"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">tmp </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c</span><span class="ansi38-220">,</span><span class="ansi38-220"> cmpy</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-72"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-73"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> c </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> d</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-74"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            d </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">d</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dis</span><span class="ansi38-220">(</span><span class="ansi38-220">tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-75"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> d</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-76"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-77"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-78"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-79"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-80"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">scanf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%lf</span><span class="ansi38-229">%lf</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-81"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-82"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">printf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%.4lf</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-83"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-84"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-85"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-86"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-87">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P1439/lcs-dp.cpp</span></span>
<span id="line-88"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-89"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-90"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-91"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-92"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-93"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-94"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-95"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-96"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-97"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-98"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-99"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-100"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-101"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-102"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-103"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-104"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-105"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-106"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-107"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-108"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-109"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-110"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-111"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-112"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-113"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-114"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-115"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-116"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-117"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-118"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-119"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-120"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-121"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-122"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-123"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-124"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-125"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-126"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-127"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-128"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-129"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-130"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-131"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> mp</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-132"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-133"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-134"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-135"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> mp</span><span class="ansi38-220">[</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-136"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-137"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> mp</span><span class="ansi38-220">[</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-138"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">b </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">ans</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-139"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            f</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">ans</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-140"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-141"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">lower_bound</span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> ans</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> f</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-142"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            f</span><span class="ansi38-220">[</span><span class="ansi38-220">p</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">f</span><span class="ansi38-220">[</span><span class="ansi38-220">p</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-143"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-144"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-145"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-146"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-147"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-148"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-149"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-150">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P1908/inversion-pair-fenwick-tree.cpp</span></span>
<span id="line-151"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-152"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-153"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-154"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-155"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-156"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-157"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-158"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-159"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-160"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-161"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-162"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-163"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-164"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-165"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-166"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-167"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-168"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-169"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-170"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-171"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-172"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-173"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-174"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-175"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-176"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-177"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-178"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-179"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-180"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-181"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-182"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-183"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-184"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-185"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-186"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-187"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-188"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-189"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-190"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-191"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-192"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-193"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-194"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-195"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-196"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">_</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-197"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> v</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220">p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-198"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-199"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">operator&lt;</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> _ </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> v </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">v</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-200"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"> a_</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-201"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-202"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-203"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-204"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-205"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">+=</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-206"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-207"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-208"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-209"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-210"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;=</span><span class="ansi38-220"> k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-211"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-212"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-213"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-214"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-215"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-216"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a_</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">v</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> a_</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">p</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-217"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">a_ </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> a_ </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-218"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-219"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        a_</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">v</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> a_</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">v</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">j </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220">a_</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">p</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> j</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-220"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-221"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-222"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-223"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-224"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-225"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-226">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P1908/inversion-pair-merge-sort.cpp</span></span>
<span id="line-227"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-228"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-229"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-230"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-231"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-232"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-233"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-234"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-235"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-236"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-237"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-238"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-239"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-240"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-241"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-242"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-243"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-244"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-245"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-246"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-247"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-248"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-249"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-250"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-251"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-252"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-253"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-254"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-255"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-256"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-257"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-258"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-259"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-260"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-261"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-262"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-263"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-264"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-265"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-266"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-267"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-268"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-269"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-270"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-271"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-272"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-273"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">solve</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-274"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-275"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-276"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-277"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> q </span><span class="ansi38-198">=</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-278"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> q </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-279"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">p</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-280"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> m </span><span class="ansi38-198">-</span><span class="ansi38-220"> p </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">o</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-281"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-282"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">o</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">p</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-283"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">o</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">p</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-284"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">q </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> tmp</span><span class="ansi38-220">[</span><span class="ansi38-220">o</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-285"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">copy</span><span class="ansi38-220">(</span><span class="ansi38-220">tmp </span><span class="ansi38-198">+</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> tmp </span><span class="ansi38-198">+</span><span class="ansi38-220"> r </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> l</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-286"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-287"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-288"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-289"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-290"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-291"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-292"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-293"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-294"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-295"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-296">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P1939/matrix-exponentiation.cpp</span></span>
<span id="line-297"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-298"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-299"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-300"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-301"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-302"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-303"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-304"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-305"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-306"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-307"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-308"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-309"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-310"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-311"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-312"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-313"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-314"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-315"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-316"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-317"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-318"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-319"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-320"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-321"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-322"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-323"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-324"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-325"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-326"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-327"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-328"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-329"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-330"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-331"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-332"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-333"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-334"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-335"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-336"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-337"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-338"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-339"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">,</span><span class="ansi38-220"> mod </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1000000007</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-340"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-341"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">mat</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-342"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-343"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-344"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">mat</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">:</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-345"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-346"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-347"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-348"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-349"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    mat </span><span class="ansi38-198">&amp;</span><span class="ansi38-97">operator*=</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> mat </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-350"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> bb </span><span class="ansi38-198">=</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-351"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        mat </span><span class="ansi38-224">ret</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> bb</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-352"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-353"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> bb</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-354"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-355"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"></span></span>
<span id="line-356"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                        </span><span class="ansi38-220">(</span><span class="ansi38-220">ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> mod</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-357"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        a </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-358"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-359"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-360"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">this</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-361"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-362"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-363"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-364"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-365"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-366"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-367"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-368"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-369"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">1</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-370"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-371"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-372"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        n </span><span class="ansi38-198">-=</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-373"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        mat </span><span class="ansi38-224">b</span><span class="ansi38-220">(</span><span class="ansi38-229">3</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">(</span><span class="ansi38-229">3</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">(</span><span class="ansi38-229">3</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-374"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        b</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-375"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> p</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-376"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> n </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> n </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">*=</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">*=</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-377"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-378"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        p </span><span class="ansi38-198">*=</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-379"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-380"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-381"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-382"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-383"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-384">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P2197/nim-game.cpp</span></span>
<span id="line-385"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-386"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-387"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-388"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-389"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-390"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-391"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-392"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-393"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-394"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-395"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-396"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-397"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-398"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-399"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-400"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-401"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-402"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-403"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-404"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-405"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-406"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-407"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-408"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-409"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-410"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-411"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-412"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-413"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-414"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-415"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-416"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-417"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-418"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-419"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-420"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-421"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-422"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-423"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-424"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-425"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-426"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-427"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-428"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-429"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-430"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> xs </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-431"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> xs </span><span class="ansi38-198">^=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-432"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-220">xs </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">Yes</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">No</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-433"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-434"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-435"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-436"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-437"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-438">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P2341/scc-tarjan.cpp</span></span>
<span id="line-439"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-440"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-441"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-442"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-443"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-444"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-445"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-446"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-447"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-448"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-449"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-450"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-451"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-452"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-453"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-454"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-455"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-456"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-457"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-458"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-459"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-460"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-461"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-462"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-463"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-464"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-465"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-466"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-467"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-468"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-469"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-470"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-471"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-472"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-473"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-474"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-475"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-476"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-477"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-478"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-479"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-480"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-481"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">50010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-482"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-483"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    disc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> top </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> scc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> deg</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-484"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-485"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-486"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-487"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">disc</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">top</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-488"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-489"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-490"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-491"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-492"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-493"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-494"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-495"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-496"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">++</span><span class="ansi38-220">scc</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-497"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-198">--</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-498"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            id</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> scc</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">scc</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-499"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-500"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-501"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-502"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-503"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-504"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-505"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-506"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-507"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-508"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-509"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-510"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-511"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-512"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> u </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">u</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-513"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-514"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-515"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">deg</span><span class="ansi38-220">[</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-516"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-517"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> scc</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-518"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">deg</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-519"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-520"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">0</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-521"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-522"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-523"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-524"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-525"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">ans</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-526"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-527"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-528"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-529"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-530">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P2485/modular-exponentiation-extended-euclidean-bsgs.cpp</span></span>
<span id="line-531"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-532"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-533"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-534"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-535"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-536"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-537"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-538"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-539"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-540"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-541"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-542"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-543"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-544"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-545"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-546"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-547"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-548"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-549"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-550"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-551"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-552"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-553"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-554"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-555"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-556"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-557"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-558"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-559"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-560"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-561"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-562"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-563"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-564"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-565"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-566"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-567"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-568"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-569"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-570"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-571"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-572"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-573"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-574"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-575"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> ans </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-576"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-577"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-578"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-579"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-580"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-581"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-582"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-583"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-584"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y0</span><span class="ansi38-220">,</span><span class="ansi38-220"> c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">%</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> x0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y0</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-585"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    x </span><span class="ansi38-198">=</span><span class="ansi38-220"> y0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> x0 </span><span class="ansi38-198">-</span><span class="ansi38-220"> a </span><span class="ansi38-198">/</span><span class="ansi38-220"> b </span><span class="ansi38-198">*</span><span class="ansi38-220"> y0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-586"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-587"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-588"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-589"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">bsgs</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-590"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">a </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">!</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-591"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">a </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">b </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> a</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-592"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">sqrt</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> an </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-593"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    unordered_map</span><span class="ansi38-220">&lt;</span><span class="ansi38-198">int</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"> mp</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-594"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> r </span><span class="ansi38-198">*</span><span class="ansi38-220"> a </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> mp</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-595"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> l </span><span class="ansi38-198">=</span><span class="ansi38-220"> an</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">,</span><span class="ansi38-220"> l </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> l </span><span class="ansi38-198">*</span><span class="ansi38-220"> an </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-596"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">mp</span><span class="ansi38-220">.</span><span class="ansi38-224">count</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> i </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> mp</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-597"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-598"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-599"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-600"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-601"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-602"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-603"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> z </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-604"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">k </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-605"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            y </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-606"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">k </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-607"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            y </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> z </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-608"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">y </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> z</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-609"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">Orz, I cannot find x!</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-610"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-611"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-612"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> t</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-613"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> t</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> z </span><span class="ansi38-198">%</span><span class="ansi38-220"> p </span><span class="ansi38-198">+</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-614"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-615"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            y </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> z </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-616"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">bsgs</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-617"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">~</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-618"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-619"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-620"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">Orz, I cannot find x!</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-621"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-622"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-623"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-624"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-625"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-626"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-627">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P2613/fermat-little-theorem.cpp</span></span>
<span id="line-628"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-629"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-630"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-631"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-632"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-633"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-634"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-635"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-636"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-637"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-638"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-639"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-640"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-641"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-642"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-643"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-644"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-645"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-646"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-647"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-648"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-649"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-650"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-651"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-652"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-653"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-654"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-655"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-656"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-657"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-658"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-659"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-660"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-661"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-662"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-663"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-664"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-665"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-666"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-667"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-668"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-669"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-670"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> P </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">19260817</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-671"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-672"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">mgu</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-673"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-674"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-675"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-676"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-677"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-678"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-679"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-680"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-681"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-682"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-683"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-684"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> ans </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-685"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-686"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-687"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-688"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-689"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">mgu</span><span class="ansi38-220">(</span><span class="ansi38-220">P</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-224">mgu</span><span class="ansi38-220">(</span><span class="ansi38-220">P</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> P </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">,</span><span class="ansi38-220"> P</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> P</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-690"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-691"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-692"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-693"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">Angry!</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-694"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-695"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-696"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-697"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-698">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P2801/square-root-decomposition.cpp</span></span>
<span id="line-699"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-700"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-701"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-702"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-703"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-704"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-705"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-706"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-707"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-708"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-709"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-710"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-711"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-712"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-713"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-714"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-715"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-716"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-717"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-718"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-719"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-720"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-721"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-722"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-723"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-724"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-725"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-726"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-727"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-728"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-729"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-730"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-731"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-732"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-733"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-734"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-735"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-736"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-737"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-738"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-739"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-740"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-741"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">char</span><span class="ansi38-220"> </span><span class="ansi38-97">gc</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-742"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-743"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-97">isspace</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-744"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-745"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-746"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-747"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-748"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1000010</span><span class="ansi38-220">,</span><span class="ansi38-220"> B </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-749"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">,</span><span class="ansi38-220"> bs</span><span class="ansi38-220">,</span><span class="ansi38-220"> bc</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">B</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">B</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> t</span><span class="ansi38-220">[</span><span class="ansi38-220">B</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-750"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-751"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">reset</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">bb</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-752"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">copy</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">+</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">bb</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">bb</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">bb</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-753"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">b </span><span class="ansi38-198">+</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">bb</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">bb</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-754"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-755"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-756"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">init</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-757"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    bs </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">sqrt</span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> bc </span><span class="ansi38-198">=</span><span class="ansi38-220"> n </span><span class="ansi38-198">/</span><span class="ansi38-220"> bs</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-758"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">bs </span><span class="ansi38-198">*</span><span class="ansi38-220"> bc </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">bc</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-759"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">/</span><span class="ansi38-220"> bs </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-760"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> bc</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> bs </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">*</span><span class="ansi38-220"> bs</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-761"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    rr</span><span class="ansi38-220">[</span><span class="ansi38-220">bc</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-762"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> bc</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">reset</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-763"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-764"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-765"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">w</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-766"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">rr</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> w</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-767"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">reset</span><span class="ansi38-220">(</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-768"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-769"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> w</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-770"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">reset</span><span class="ansi38-220">(</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-771"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> t</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> w</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-772"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-773"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-774"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">w</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-775"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-776"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">rr</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-777"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> t</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> w</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-778"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-779"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-780"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> t</span><span class="ansi38-220">[</span><span class="ansi38-220">bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> w</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-781"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> bi</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-782"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-224">lower_bound</span><span class="ansi38-220">(</span><span class="ansi38-220">b </span><span class="ansi38-198">+</span><span class="ansi38-220"> ll</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> rr</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> w </span><span class="ansi38-198">-</span><span class="ansi38-220"> t</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-783"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-784"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-785"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-786"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-787"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> q </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-788"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-789"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">init</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-790"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">q</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-791"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">char</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gc</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-792"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> l </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> w </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-793"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">M</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-794"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-795"><span class="ansi38-145">  96</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-796"><span class="ansi38-145">  97</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-797"><span class="ansi38-145">  98</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-798"><span class="ansi38-145">  99</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-799"><span class="ansi38-145"> 100</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-800"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-801"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-802">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3366/kruskal.cpp</span></span>
<span id="line-803"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-804"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-805"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-806"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-807"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-808"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-809"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-810"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-811"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-812"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-813"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-814"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-815"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-816"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-817"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-818"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-819"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-820"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-821"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-822"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-823"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-824"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-825"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-826"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-827"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-828"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-829"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-830"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-831"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-832"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-833"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-834"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-835"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-836"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-837"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-838"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-839"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-840"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-841"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-842"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-843"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-844"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-845"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">5010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">200010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-846"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-847"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">edge</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-848"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-849"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-850"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">operator&lt;</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> edge </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> z </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">z</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-851"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"> e</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-852"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-853"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> len </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> ecnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-854"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-855"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">unions</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-856"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-857"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-858"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-859"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        p</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-860"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-861"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-862"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-863"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-864"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">finds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> x </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">:</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-865"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-866"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">kruskal</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-867"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-868"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> rt1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> rt2 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-869"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">rt1 </span><span class="ansi38-198">==</span><span class="ansi38-220"> rt2</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-870"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        len </span><span class="ansi38-198">+=</span><span class="ansi38-220"> e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">z</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">unions</span><span class="ansi38-220">(</span><span class="ansi38-220">rt1</span><span class="ansi38-220">,</span><span class="ansi38-220"> rt2</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-871"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ecnt </span><span class="ansi38-198">==</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-872"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-873"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-874"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-875"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-876"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-877"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-878"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">x</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">y</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> e</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">z</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-879"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">e </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> e </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">kruskal</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-880"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ecnt </span><span class="ansi38-198">==</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-881"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">len</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-882"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-883"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">orz</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-884"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-885"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-886"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-887"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-888">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3366/prim.cpp</span></span>
<span id="line-889"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-890"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-891"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-892"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-893"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-894"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-895"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-896"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-897"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-898"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-899"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-900"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-901"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-902"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-903"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-904"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-905"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-906"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-907"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-908"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-909"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-910"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-911"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-912"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-913"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-914"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-915"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-916"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-917"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-918"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-919"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-920"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-921"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-922"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-923"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-924"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-925"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-926"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-927"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-928"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-929"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-930"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-931"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">5010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">200010</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-932"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> len </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> vcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-933"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                                            hsz </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-934"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">hitm</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-935"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-936"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-937"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">operator&lt;</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> hitm </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> d </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">d</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-938"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-939"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-940"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-941"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">prim</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-942"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">}</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-943"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                     </span><span class="ansi38-224">push_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-944"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">hsz</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-945"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">pop_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-946"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-947"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-948"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> len </span><span class="ansi38-198">+=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">vcnt</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-949"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vcnt </span><span class="ansi38-198">==</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-950"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-951"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-952"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">z</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-953"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> z</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">}</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">push_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-954"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-955"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-956"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-957"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-958"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-959"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-960"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-961"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-962"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        z</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> z</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-963"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">               to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-964"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">               to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-965"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-966"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">prim</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-967"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vcnt </span><span class="ansi38-198">==</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-968"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">len</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-969"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-970"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">orz</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-971"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-972"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-973"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-974"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-975">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3367/disjoint-set.cpp</span></span>
<span id="line-976"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-977"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-978"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-979"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-980"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-981"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-982"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-983"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-984"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-985"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-986"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-987"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-988"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-989"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-990"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-991"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-992"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-993"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-994"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-995"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-996"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-997"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-998"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-999"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1000"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1001"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1002"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1003"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1004"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1005"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1006"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1007"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1008"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1009"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1010"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1011"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1012"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1013"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1014"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1015"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1016"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1017"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1018"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1019"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1020"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1021"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">finds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> x </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">:</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1022"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1023"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">unions</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1024"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1025"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1026"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">rk</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rk</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1027"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        p</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1028"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1029"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1030"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1031"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1032"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1033"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1034"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1035"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1036"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> z </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1037"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">z </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1038"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">unions</span><span class="ansi38-220">(</span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1039"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1040"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">Y</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">N</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1041"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1042"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1043"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1044"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1045"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1046">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3368/fenwick-tree.cpp</span></span>
<span id="line-1047"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1048"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1049"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1050"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1051"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1052"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1053"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1054"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1055"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1056"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1057"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1058"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1059"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1060"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1061"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1062"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1063"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1064"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1065"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1066"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1067"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1068"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1069"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1070"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1071"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1072"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1073"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1074"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1075"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1076"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1077"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1078"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1079"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1080"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1081"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1082"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1083"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1084"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1085"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1086"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1087"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1088"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1089"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1090"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1091"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1092"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1093"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">+=</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1094"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1095"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1096"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1097"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1098"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;=</span><span class="ansi38-220"> k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1099"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1100"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1101"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1102"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1103"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1104"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1105"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1106"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1107"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1108"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1109"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> k</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">y </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1110"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1111"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1112"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1113"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1114"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1115"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1116"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1117">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3370/bkdr-hash.cpp</span></span>
<span id="line-1118"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1119"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1120"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1121"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1122"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1123"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1124"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1125"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1126"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1127"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1128"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1129"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1130"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1131"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1132"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1133"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1134"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1135"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1136"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1137"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1138"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1139"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1140"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1141"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1142"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1143"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1144"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1145"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1146"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1147"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1148"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1149"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1150"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1151"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1152"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1153"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1154"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1155"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1156"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1157"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1158"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1159"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1160"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">unsigned</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> seed </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">131LL</span><span class="ansi38-220">,</span><span class="ansi38-220"> mod </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">192681719260817LL</span><span class="ansi38-220">,</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1161"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                         M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1510</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1162"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1163"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">unsigned</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">uhash</span><span class="ansi38-220">(</span><span class="ansi38-198">unsigned</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">char</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1164"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">*</span><span class="ansi38-220"> seed </span><span class="ansi38-198">+</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> mod</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1165"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1166"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1167"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1168"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">unsigned</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1169"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1170"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1171"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1172"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1173"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1174"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isalnum</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1175"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1176"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isalnum</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">uhash</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1177"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1178"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1179"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">unique</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> a </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1180"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1181"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1182"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1183"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1184">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3371/slf-spfa.cpp</span></span>
<span id="line-1185"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1186"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1187"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1188"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1189"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1190"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1191"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1192"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1193"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1194"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1195"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1196"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1197"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1198"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1199"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1200"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1201"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1202"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1203"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1204"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1205"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1206"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1207"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1208"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1209"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1210"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1211"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1212"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1213"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1214"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1215"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1216"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1217"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1218"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1219"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1220"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1221"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1222"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1223"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1224"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1225"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1226"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1227"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1228"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> head</span><span class="ansi38-220">,</span><span class="ansi38-220"> tail</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1229"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1230"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1231"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-97">qo</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> x </span><span class="ansi38-198">==</span><span class="ansi38-220"> N </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> x </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1232"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1233"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">spfa</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1234"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">s</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> head </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> tail </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1235"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                     q</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">s</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1236"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">head </span><span class="ansi38-198">!=</span><span class="ansi38-220"> tail </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1237"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-220">head</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1238"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">qo</span><span class="ansi38-220">(</span><span class="ansi38-220">head</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1239"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1240"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ndis </span><span class="ansi38-198">=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1241"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ndis </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1242"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ndis</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1243"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1244"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ndis </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-220">[</span><span class="ansi38-220">head</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1245"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                        q</span><span class="ansi38-220">[</span><span class="ansi38-224">qo</span><span class="ansi38-220">(</span><span class="ansi38-198">--</span><span class="ansi38-220">head</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1246"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1247"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                        q</span><span class="ansi38-220">[</span><span class="ansi38-224">qo</span><span class="ansi38-220">(</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1248"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1249"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1250"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1251"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1252"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1253"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1254"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1255"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1256"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> s </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1257"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1258"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1259"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1260"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1261"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">spfa</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1262"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1263"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1264"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1265"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1266"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1267"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1268">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3371/spfa.cpp</span></span>
<span id="line-1269"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1270"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1271"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1272"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1273"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1274"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1275"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1276"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1277"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1278"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1279"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1280"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1281"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1282"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1283"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1284"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1285"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1286"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1287"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1288"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1289"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1290"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1291"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1292"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1293"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1294"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1295"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1296"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1297"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1298"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1299"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1300"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1301"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1302"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1303"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1304"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1305"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1306"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1307"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1308"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1309"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1310"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1311"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1312"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> head </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> tail </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1313"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1314"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1315"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-97">qo</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> x </span><span class="ansi38-198">==</span><span class="ansi38-220"> N </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1316"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1317"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">spfa</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1318"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">s</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">s</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1319"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">head </span><span class="ansi38-198">!=</span><span class="ansi38-220"> tail </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1320"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-220">head</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1321"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">qo</span><span class="ansi38-220">(</span><span class="ansi38-220">head</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1322"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1323"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ndis </span><span class="ansi38-198">=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1324"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ndis </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1325"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ndis</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1326"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> q</span><span class="ansi38-220">[</span><span class="ansi38-224">qo</span><span class="ansi38-220">(</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1327"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1328"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1329"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1330"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1331"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1332"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1333"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> s </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1334"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1335"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1336"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1337"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1338"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">spfa</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1339"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1340"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1341"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1342"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1343"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1344"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1345">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3372/fenwick-tree.cpp</span></span>
<span id="line-1346"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1347"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1348"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1349"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1350"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1351"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1352"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1353"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1354"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1355"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1356"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1357"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1358"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1359"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1360"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1361"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1362"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1363"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1364"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1365"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1366"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1367"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1368"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1369"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1370"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1371"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1372"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1373"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1374"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1375"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1376"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1377"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1378"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1379"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1380"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1381"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1382"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1383"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1384"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1385"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1386"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1387"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1388"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1389"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1390"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit1</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit2</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1391"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1392"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">bit</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1393"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">+=</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1394"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1395"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1396"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">bit</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1397"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1398"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;=</span><span class="ansi38-220"> k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1399"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1400"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1401"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1402"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1403"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1404"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1405"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1406"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1407"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1408"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1409"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> k</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> k </span><span class="ansi38-198">*</span><span class="ansi38-220"> x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1410"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">y </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1411"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1412"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">s</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">y </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">x </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"></span></span>
<span id="line-1413"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                  x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1414"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1415"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1416"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1417"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1418"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1419">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3372/segment-tree.cpp</span></span>
<span id="line-1420"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1421"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1422"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1423"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1424"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1425"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1426"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1427"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1428"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1429"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1430"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1431"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1432"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1433"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1434"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1435"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1436"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1437"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1438"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1439"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1440"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1441"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1442"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1443"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1444"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1445"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1446"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1447"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1448"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1449"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1450"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1451"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1452"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1453"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1454"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1455"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1456"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1457"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1458"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1459"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1460"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1461"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1462"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1463"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1464"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1465"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1466"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">L</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1467"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">R</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1468"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1469"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">push</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1470"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1471"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1472"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1473"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        addt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1474"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1475"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1476"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">add</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1477"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rr </span><span class="ansi38-198">||</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ll</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1478"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> ll </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1479"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> v </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1480"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1481"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1482"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1483"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1484"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1485"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1486"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1487"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1488"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1489"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rr </span><span class="ansi38-198">||</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ll</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1490"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> ll </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1491"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1492"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1493"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1494"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1495"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1496"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">bld</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1497"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">==</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1498"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1499"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1500"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1501"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1502"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1503"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1504"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1505"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1506"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1507"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1508"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1509"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1510"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1511"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1512"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1513"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1514"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1515"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1516"><span class="ansi38-145">  96</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1517"><span class="ansi38-145">  97</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1518"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1519"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1520">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3373/segment-tree.cpp</span></span>
<span id="line-1521"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1522"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1523"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1524"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1525"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1526"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1527"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1528"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1529"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1530"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1531"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1532"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1533"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1534"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1535"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1536"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1537"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1538"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1539"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1540"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1541"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1542"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1543"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1544"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1545"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1546"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1547"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1548"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1549"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1550"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1551"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1552"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1553"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1554"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1555"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1556"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1557"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1558"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1559"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1560"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1561"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1562"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1563"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1564"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1565"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1566"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1567"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">L</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1568"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">R</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1569"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1570"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">push</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1571"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1572"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1573"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1574"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1575"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    addt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1576"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    addt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1577"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    mult</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1578"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1579"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1580"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1581"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">add</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1582"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rr </span><span class="ansi38-198">||</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ll</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1583"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> ll </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1584"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> v </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1585"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1586"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1587"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1588"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1589"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1590"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1591"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1592"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1593"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">mul</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1594"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rr </span><span class="ansi38-198">||</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ll</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1595"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> ll </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1596"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">addt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1597"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1598"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1599"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1600"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1601"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1602"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">mul</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">mul</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1603"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1604"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1605"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1606"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1607"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rr </span><span class="ansi38-198">||</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ll</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1608"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> ll </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> r </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1609"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1610"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1611"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> ll</span><span class="ansi38-220">,</span><span class="ansi38-220"> rr</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1612"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1613"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1614"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">bld</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1615"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    mult</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1616"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">==</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1617"><span class="ansi38-145">  96</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1618"><span class="ansi38-145">  97</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1619"><span class="ansi38-145">  98</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1620"><span class="ansi38-145">  99</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1621"><span class="ansi38-145"> 100</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-220">L</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-220">R</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sgt</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1622"><span class="ansi38-145"> 101</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1623"><span class="ansi38-145"> 102</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1624"><span class="ansi38-145"> 103</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1625"><span class="ansi38-145"> 104</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1626"><span class="ansi38-145"> 105</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1627"><span class="ansi38-145"> 106</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">bld</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1628"><span class="ansi38-145"> 107</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1629"><span class="ansi38-145"> 108</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1630"><span class="ansi38-145"> 109</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1631"><span class="ansi38-145"> 110</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">mul</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1632"><span class="ansi38-145"> 111</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1633"><span class="ansi38-145"> 112</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">add</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1634"><span class="ansi38-145"> 113</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1635"><span class="ansi38-145"> 114</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1636"><span class="ansi38-145"> 115</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1637"><span class="ansi38-145"> 116</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1638"><span class="ansi38-145"> 117</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1639"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1640"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1641">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3374/fenwick-tree.cpp</span></span>
<span id="line-1642"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1643"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1644"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1645"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1646"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1647"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1648"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1649"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1650"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1651"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1652"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1653"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1654"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1655"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1656"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1657"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1658"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1659"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1660"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1661"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1662"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1663"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1664"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1665"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1666"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1667"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1668"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1669"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1670"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1671"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1672"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1673"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1674"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1675"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1676"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1677"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1678"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1679"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1680"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1681"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1682"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1683"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1684"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1685"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1686"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1687"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1688"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">+=</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1689"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1690"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1691"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1692"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1693"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;=</span><span class="ansi38-220"> k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1694"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1695"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1696"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1697"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1698"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1699"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1700"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1701"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1702"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1703"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1704"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-1705"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">s</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">x </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1706"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1707"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1708"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1709"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1710"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1711">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3375/kmp.cpp</span></span>
<span id="line-1712"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1713"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1714"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1715"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1716"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1717"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1718"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1719"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1720"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1721"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1722"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1723"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1724"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1725"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1726"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1727"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1728"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1729"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1730"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1731"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1732"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1733"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1734"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1735"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1736"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1737"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1738"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1739"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1740"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1741"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1742"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1743"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1744"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1745"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1746"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1747"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1748"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1749"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1750"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1751"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1752"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1753"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1754"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1000010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1755"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">char</span><span class="ansi38-220"> s1</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> s2</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1756"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> fail</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> len1</span><span class="ansi38-220">,</span><span class="ansi38-220"> len2</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1757"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1758"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1759"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">scanf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%s</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> s1 </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> len1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">strlen</span><span class="ansi38-220">(</span><span class="ansi38-220">s1 </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">scanf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%s</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> s2 </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1760"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                         len2 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">strlen</span><span class="ansi38-220">(</span><span class="ansi38-220">s2 </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> fail</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1761"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> len2</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1762"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> fail</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1763"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">j </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> s2</span><span class="ansi38-220">[</span><span class="ansi38-220">j </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> s2</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> fail</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1764"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        fail</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> j </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1765"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1766"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> len1</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1767"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">j </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> s2</span><span class="ansi38-220">[</span><span class="ansi38-220">j </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> s1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> fail</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1768"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">++</span><span class="ansi38-220">j </span><span class="ansi38-198">==</span><span class="ansi38-220"> len2</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> len2 </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1769"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1770"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> len2</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">fail</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1771"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1772"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1773"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1774"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1775"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1776">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3377/leftist-tree.cpp</span></span>
<span id="line-1777"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1778"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1779"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1780"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1781"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1782"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1783"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1784"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1785"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1786"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1787"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1788"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1789"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1790"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1791"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1792"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1793"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1794"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1795"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1796"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1797"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1798"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1799"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1800"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1801"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1802"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1803"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1804"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1805"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1806"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1807"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1808"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1809"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1810"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1811"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1812"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1813"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1814"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1815"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1816"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1817"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1818"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1819"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1820"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1821"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1822"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1823"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">finds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> x </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">:</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1824"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1825"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">mrg</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1826"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">l </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-198">!</span><span class="ansi38-220">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> l </span><span class="ansi38-198">|</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1827"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">==</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1828"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> l </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1829"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    p</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1830"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1831"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dis</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1832"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> l</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1833"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1834"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1835"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1836"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1837"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1838"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dis</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1839"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1840"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> op </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1841"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">op </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1842"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1843"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1844"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1845"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1846"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1847"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">-1</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1848"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1849"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1850"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">int</span><span class="ansi38-220"> rt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1851"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1852"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                              p</span><span class="ansi38-220">[</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-1853"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                              p</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1854"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1855"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1856"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1857"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1858"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1859"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1860"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1861">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3377/pairing-heap.cpp</span></span>
<span id="line-1862"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1863"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1864"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1865"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1866"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1867"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1868"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1869"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1870"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1871"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1872"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1873"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1874"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1875"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1876"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1877"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1878"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1879"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1880"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1881"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1882"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1883"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1884"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1885"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1886"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1887"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1888"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1889"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1890"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1891"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1892"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1893"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1894"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1895"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1896"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1897"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1898"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1899"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1900"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1901"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1902"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1903"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1904"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1905"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1906"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> sib</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1907"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1908"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">finds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> x </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">:</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1909"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1910"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">mrg</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1911"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">x </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-198">!</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> x </span><span class="ansi38-198">|</span><span class="ansi38-220"> y</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1912"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1913"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sib</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1914"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1915"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1916"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1917"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">mrgl</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1918"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">l0 </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-198">!</span><span class="ansi38-220">sib</span><span class="ansi38-220">[</span><span class="ansi38-220">l0</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">l0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> l0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1919"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> l1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> sib</span><span class="ansi38-220">[</span><span class="ansi38-220">l0</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> l2 </span><span class="ansi38-198">=</span><span class="ansi38-220"> sib</span><span class="ansi38-220">[</span><span class="ansi38-220">l1</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1920"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sib</span><span class="ansi38-220">[</span><span class="ansi38-220">l0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> sib</span><span class="ansi38-220">[</span><span class="ansi38-220">l1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1921"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-220">l0</span><span class="ansi38-220">,</span><span class="ansi38-220"> l1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">mrgl</span><span class="ansi38-220">(</span><span class="ansi38-220">l2</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1922"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1923"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1924"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1925"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1926"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1927"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1928"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> op </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1929"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">op </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1930"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1931"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">mrg</span><span class="ansi38-220">(</span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1932"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1933"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1934"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1935"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">-1</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1936"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1937"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1938"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">int</span><span class="ansi38-220"> rt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1939"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">mrgl</span><span class="ansi38-220">(</span><span class="ansi38-220">c</span><span class="ansi38-220">[</span><span class="ansi38-220">rt</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1940"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1941"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1942"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1943"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1944"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1945"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1946"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1947">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3378/binary-heap.cpp</span></span>
<span id="line-1948"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-1949"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1950"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1951"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1952"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-1953"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1954"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1955"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1956"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1957"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1958"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1959"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1960"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1961"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1962"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1963"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1964"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1965"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1966"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1967"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1968"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1969"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1970"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1971"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1972"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1973"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1974"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1975"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1976"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1977"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1978"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1979"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1980"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1981"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1982"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1983"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1984"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-1985"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1986"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1987"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-1988"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-1989"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1990"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1000000</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1991"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">N </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-1992"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1993"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">sz</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"></span></span>
<span id="line-1994"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">L</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1995"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">R</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1996"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#define</span><span class="ansi38-220"> </span><span class="ansi38-220">P</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-1997"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-1998"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">minson</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-1999"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> l </span><span class="ansi38-198">=</span><span class="ansi38-220"> L </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> sz </span><span class="ansi38-198">?</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">L</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> inf</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> R </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> sz </span><span class="ansi38-198">?</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">R</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> inf</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2000"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> l </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> r </span><span class="ansi38-198">?</span><span class="ansi38-220"> L </span><span class="ansi38-198">:</span><span class="ansi38-220"> R</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2001"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2002"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2003"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">heapup</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2004"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">P</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">P</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2005"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2006"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2007"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">heapdown</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2008"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ms</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2009"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">L </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> sz </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">ms </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">minson</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">ms</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> ms</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2010"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2011"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2012"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2013"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2014"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">switch</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2015"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">case</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">:</span><span class="ansi38-220"></span></span>
<span id="line-2016"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                h</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">sz</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">heapup</span><span class="ansi38-220">(</span><span class="ansi38-220">sz</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2017"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2018"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">case</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">:</span><span class="ansi38-220"></span></span>
<span id="line-2019"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2020"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2021"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">case</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">:</span><span class="ansi38-220"></span></span>
<span id="line-2022"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">sz</span><span class="ansi38-198">--</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">heapdown</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2023"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2024"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2025"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2026"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2027"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2028"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2029">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3379/lca-sparse-table.cpp</span></span>
<span id="line-2030"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2031"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2032"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2033"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2034"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2035"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2036"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2037"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2038"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2039"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2040"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2041"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2042"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2043"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2044"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2045"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2046"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2047"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2048"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2049"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2050"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2051"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2052"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2053"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2054"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2055"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2056"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2057"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2058"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2059"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2060"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2061"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2062"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2063"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2064"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2065"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2066"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2067"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2068"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2069"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2070"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2071"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2072"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">,</span><span class="ansi38-220"> E </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2073"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">22</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2074"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2075"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2076"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2077"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2078"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2079"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2080"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2081"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">init</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2082"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> log2d </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2083"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> log2d</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">anc</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2084"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2085"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2086"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2087"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        anc</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">init</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2088"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2089"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2090"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2091"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">lca</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2092"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2093"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2094"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2095"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> d </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> d </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">--</span><span class="ansi38-220">d</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2096"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">anc</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">d</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">d</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">d</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">d</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2097"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> anc</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2098"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2099"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2100"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2101"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> s </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2102"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2103"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2104"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2105"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2106"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2107"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">init</span><span class="ansi38-220">(</span><span class="ansi38-220">s</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2108"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2109"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2110"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">lca</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2111"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2112"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2113"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2114"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2115"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2116">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3379/lca-tarjan.cpp</span></span>
<span id="line-2117"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2118"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2119"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2120"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2121"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2122"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2123"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2124"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2125"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2126"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2127"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2128"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2129"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2130"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2131"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2132"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2133"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2134"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2135"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2136"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2137"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2138"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2139"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2140"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2141"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2142"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2143"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2144"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2145"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2146"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2147"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2148"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2149"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2150"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2151"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2152"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2153"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2154"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2155"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2156"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2157"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2158"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2159"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">500010</span><span class="ansi38-220">,</span><span class="ansi38-220"> E </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2160"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> qi</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2161"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> ck</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2162"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2163"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">finds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> x </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">:</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">p</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2164"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2165"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">fa</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2166"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2167"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2168"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2169"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2170"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2171"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> q </span><span class="ansi38-198">=</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> q</span><span class="ansi38-220">;</span><span class="ansi38-220"> q </span><span class="ansi38-198">=</span><span class="ansi38-220"> q1</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2172"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> q </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> qi</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2173"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">ck</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2174"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            ck</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2175"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-2176"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            ans</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">finds</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2177"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2178"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2179"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2180"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2181"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> s </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2182"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2183"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2184"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2185"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2186"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2187"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2188"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2189"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        q1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> qi</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2190"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                q1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> q0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> qi</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2191"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2192"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> p</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2193"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">s</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2194"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2195"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2196"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2197"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2198"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2199">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3382/ternary-search.cpp</span></span>
<span id="line-2200"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2201"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2202"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2203"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2204"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2205"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2206"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2207"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2208"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2209"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2210"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2211"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2212"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2213"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2214"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2215"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2216"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2217"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2218"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2219"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2220"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2221"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2222"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2223"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2224"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2225"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2226"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2227"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2228"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2229"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2230"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2231"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2232"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2233"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2234"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2235"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2236"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2237"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2238"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2239"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2240"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2241"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2242"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">20</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2243"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">double</span><span class="ansi38-220"> eps </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1e-7</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2244"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2245"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">double</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2246"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2247"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-97">f</span><span class="ansi38-220">(</span><span class="ansi38-198">double</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2248"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">double</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2249"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">--</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> ans </span><span class="ansi38-198">*</span><span class="ansi38-220"> x </span><span class="ansi38-198">+</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2250"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2251"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2252"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2253"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2254"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">scanf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%lf</span><span class="ansi38-229">%lf</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-220">r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2255"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">--</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">scanf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%lf</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2256"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> eps</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2257"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">double</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">l </span><span class="ansi38-198">+</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2258"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-224">f</span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">-</span><span class="ansi38-220"> eps</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-224">f</span><span class="ansi38-220">(</span><span class="ansi38-220">m </span><span class="ansi38-198">+</span><span class="ansi38-220"> eps</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2259"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            l </span><span class="ansi38-198">=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2260"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-2261"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            r </span><span class="ansi38-198">=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2262"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2263"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">printf</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-229">%.5lf</span><span class="ansi38-86">\n</span><span class="ansi38-152">"</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2264"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2265"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2266"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2267"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2268">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3383/miller-rabin.cpp</span></span>
<span id="line-2269"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2270"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2271"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2272"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2273"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2274"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2275"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2276"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2277"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2278"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2279"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2280"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2281"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2282"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2283"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2284"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2285"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2286"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2287"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2288"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2289"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2290"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2291"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2292"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2293"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2294"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2295"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2296"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2297"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2298"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2299"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2300"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2301"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2302"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2303"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2304"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2305"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2306"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2307"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2308"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2309"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2310"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2311"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> base</span><span class="ansi38-220">[</span><span class="ansi38-229">8</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-229">2</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">5</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">7</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">11</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">13</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">17</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">19</span><span class="ansi38-220">}</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2312"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2313"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2314"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2315"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2316"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> ans </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2317"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2318"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2319"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2320"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">miller_test</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">d</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2321"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">==</span><span class="ansi38-220"> a</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2322"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">%</span><span class="ansi38-220"> a</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2323"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2324"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> x </span><span class="ansi38-198">==</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2325"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">d </span><span class="ansi38-198">!=</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2326"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> x </span><span class="ansi38-198">%</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> d </span><span class="ansi38-198">&lt;&lt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2327"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2328"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">==</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2329"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2330"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2331"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2332"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2333"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">miller_rabin</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2334"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2335"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> d </span><span class="ansi38-198">=</span><span class="ansi38-220"> n </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2336"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">d </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> d </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2337"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">8</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2338"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-224">miller_test</span><span class="ansi38-220">(</span><span class="ansi38-220">base</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2339"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2340"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2341"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2342"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2343"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2344"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-224">miller_rabin</span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">Yes</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">No</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2345"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2346"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2347"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2348"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2349">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3383/sieve-of-euler.cpp</span></span>
<span id="line-2350"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2351"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2352"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2353"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2354"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2355"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2356"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2357"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2358"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2359"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2360"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2361"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2362"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2363"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2364"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2365"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2366"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2367"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2368"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2369"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2370"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2371"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2372"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2373"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2374"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2375"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2376"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2377"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2378"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2379"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2380"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2381"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2382"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2383"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2384"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2385"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2386"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2387"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2388"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2389"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2390"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2391"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2392"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10000010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2393"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> prime</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> pcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2394"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> nprime</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2395"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2396"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2397"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2398"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    nprime</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2399"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2400"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">nprime</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> prime</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">pcnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2401"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> pcnt </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> i </span><span class="ansi38-198">*</span><span class="ansi38-220"> prime</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2402"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            nprime</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">*</span><span class="ansi38-220"> prime</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2403"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">%</span><span class="ansi38-220"> prime</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2404"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2405"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2406"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-220">nprime</span><span class="ansi38-220">[</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">No</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">Yes</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2407"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2408"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2409"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2410"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2411">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3384/heavy-light-decomposition-fenwick-tree.cpp</span></span>
<span id="line-2412"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2413"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2414"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2415"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2416"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2417"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2418"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2419"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2420"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2421"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2422"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2423"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2424"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2425"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2426"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2427"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2428"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2429"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2430"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2431"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2432"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2433"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2434"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2435"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2436"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2437"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2438"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2439"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2440"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2441"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2442"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2443"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2444"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2445"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2446"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2447"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2448"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2449"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2450"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2451"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2452"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2453"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2454"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">,</span><span class="ansi38-220"> E </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2455"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit1</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> bit2</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2456"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    h</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> top</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> cnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2457"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2458"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">bit</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2459"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">+=</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2460"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2461"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2462"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">bit</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2463"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2464"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;=</span><span class="ansi38-220"> k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">+</span><span class="ansi38-220"> bit</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2465"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2466"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2467"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2468"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">upds</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2469"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> v </span><span class="ansi38-198">*</span><span class="ansi38-220"> l </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2470"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">upd</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">v </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2471"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2472"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2473"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">qrys</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2474"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"></span></span>
<span id="line-2475"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> l </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit1</span><span class="ansi38-220">,</span><span class="ansi38-220"> l </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qry</span><span class="ansi38-220">(</span><span class="ansi38-220">bit2</span><span class="ansi38-220">,</span><span class="ansi38-220"> l </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"></span></span>
<span id="line-2476"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">           p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2477"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2478"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2479"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">dfs1</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2480"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2481"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2482"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2483"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2484"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        dep</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs1</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2485"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2486"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2487"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2488"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2489"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2490"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">dfs2</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2491"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    id</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">cnt</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2492"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2493"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    top</span><span class="ansi38-220">[</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> top</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs2</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2494"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2495"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2496"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2497"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        top</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs2</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2498"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2499"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2500"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2501"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2502"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2503"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2504"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2505"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2506"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2507"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2508"><span class="ansi38-145">  96</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2509"><span class="ansi38-145">  97</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">dfs1</span><span class="ansi38-220">(</span><span class="ansi38-220">r</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> top</span><span class="ansi38-220">[</span><span class="ansi38-220">r</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> r</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs2</span><span class="ansi38-220">(</span><span class="ansi38-220">r</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2510"><span class="ansi38-145">  98</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">upds</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> a</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2511"><span class="ansi38-145">  99</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2512"><span class="ansi38-145"> 100</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> o </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2513"><span class="ansi38-145"> 101</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2514"><span class="ansi38-145"> 102</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> z </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2515"><span class="ansi38-145"> 103</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> top</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2516"><span class="ansi38-145"> 104</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2517"><span class="ansi38-145"> 105</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">upds</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2518"><span class="ansi38-145"> 106</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2519"><span class="ansi38-145"> 107</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2520"><span class="ansi38-145"> 108</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upds</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2521"><span class="ansi38-145"> 109</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2522"><span class="ansi38-145"> 110</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2523"><span class="ansi38-145"> 111</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">!=</span><span class="ansi38-220"> top</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2524"><span class="ansi38-145"> 112</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2525"><span class="ansi38-145"> 113</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qrys</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> fa</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2526"><span class="ansi38-145"> 114</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2527"><span class="ansi38-145"> 115</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dep</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dep</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2528"><span class="ansi38-145"> 116</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-224">qrys</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p </span><span class="ansi38-198">+</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2529"><span class="ansi38-145"> 117</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">o </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-229">3</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2530"><span class="ansi38-145"> 118</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> z </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2531"><span class="ansi38-145"> 119</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">upds</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> z</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2532"><span class="ansi38-145"> 120</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2533"><span class="ansi38-145"> 121</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2534"><span class="ansi38-145"> 122</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-224">qrys</span><span class="ansi38-220">(</span><span class="ansi38-220">id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> id</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p </span><span class="ansi38-198">+</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2535"><span class="ansi38-145"> 123</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2536"><span class="ansi38-145"> 124</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2537"><span class="ansi38-145"> 125</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2538"><span class="ansi38-145"> 126</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2539"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2540"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2541">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3385/negative-cycle-bfs-spfa.cpp</span></span>
<span id="line-2542"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2543"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2544"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2545"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2546"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2547"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2548"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2549"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2550"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2551"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2552"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2553"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2554"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2555"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2556"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2557"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2558"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2559"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2560"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2561"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2562"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2563"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2564"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2565"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2566"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2567"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2568"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2569"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2570"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2571"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2572"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2573"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2574"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2575"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2576"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2577"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2578"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2579"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2580"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2581"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2582"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2583"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2584"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">3010</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">~</span><span class="ansi38-229">0U</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2585"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2586"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">M </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2587"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2588"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">queue</span><span class="ansi38-220">&lt;</span><span class="ansi38-198">int</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"> q</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2589"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2590"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">clear</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2591"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> inf</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2592"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">q</span><span class="ansi38-220">.</span><span class="ansi38-224">empty</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">q</span><span class="ansi38-220">.</span><span class="ansi38-224">front</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">.</span><span class="ansi38-224">pop</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2593"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2594"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2595"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">push</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">v</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">.</span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2596"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2597"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">pop</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2598"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> q</span><span class="ansi38-220">.</span><span class="ansi38-224">front</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> q</span><span class="ansi38-220">.</span><span class="ansi38-224">pop</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2599"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2600"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2601"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2602"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">detect</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2603"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">clear</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2604"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">q</span><span class="ansi38-220">.</span><span class="ansi38-224">empty</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2605"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">pop</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2606"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2607"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ndis </span><span class="ansi38-198">=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2608"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ndis </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2609"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ndis</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2610"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">inq</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2611"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">cnt</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2612"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">push</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2613"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2614"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2615"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2616"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2617"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2618"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2619"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2620"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> T </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2621"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">T</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2622"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2623"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> ecnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2624"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2625"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2626"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> w0 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2627"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            e1</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ecnt</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> w0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2628"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">w0 </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2629"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ecnt</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">ecnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> w0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2630"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2631"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-224">detect</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">YE5</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">N0</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2632"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2633"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2634"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2635"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2636"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2637">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3386/maximum-bipartite-matching-hungarian.cpp</span></span>
<span id="line-2638"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2639"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2640"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2641"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2642"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2643"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2644"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2645"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2646"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2647"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2648"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2649"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2650"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2651"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2652"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2653"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2654"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2655"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2656"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2657"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2658"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2659"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2660"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2661"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2662"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2663"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2664"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2665"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2666"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2667"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2668"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2669"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2670"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2671"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2672"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2673"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2674"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2675"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2676"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2677"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2678"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2679"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2680"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2681"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e</span><span class="ansi38-220">,</span><span class="ansi38-220"> xm</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ym</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2682"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> g</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2683"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2684"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">dfs</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2685"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> y </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">y</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2686"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">g</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-198">!</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2687"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            vis</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2688"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">ym</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">||</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs</span><span class="ansi38-220">(</span><span class="ansi38-220">ym</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2689"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                xm</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"> ym</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2690"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2691"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2692"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2693"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2694"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2695"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2696"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2697"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2698"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">e</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> g</span><span class="ansi38-220">[</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2699"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">vis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">+=</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2700"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2701"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2702"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2703"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2704"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2705">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3387/scc-tarjan.cpp</span></span>
<span id="line-2706"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2707"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2708"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2709"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2710"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2711"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2712"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2713"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2714"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2715"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2716"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2717"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2718"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2719"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2720"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2721"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2722"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2723"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2724"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2725"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2726"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2727"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2728"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2729"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2730"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2731"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2732"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2733"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2734"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2735"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2736"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2737"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2738"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2739"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2740"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2741"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2742"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2743"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2744"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2745"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2746"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2747"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2748"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2749"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> val</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> rep</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2750"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    top </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> disc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2751"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2752"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2753"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2754"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2755"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">disc</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">top</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2756"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2757"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2758"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2759"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2760"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2761"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2762"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2763"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2764"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-198">--</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2765"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            rep</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2766"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2767"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            val</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> val</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2768"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">e0</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2769"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2770"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    e1</span><span class="ansi38-220">[</span><span class="ansi38-220">ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2771"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-2772"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2773"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2774"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2775"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2776"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2777"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">dfs</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2778"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    u </span><span class="ansi38-198">=</span><span class="ansi38-220"> rep</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2779"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2780"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2781"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> rep</span><span class="ansi38-220">[</span><span class="ansi38-220">to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2782"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">!=</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">f</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2783"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2784"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> val</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2785"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2786"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2787"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2788"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2789"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> val</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2790"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2791"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2792"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2793"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> ee</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2794"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> v</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2795"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2796"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2797"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> rep</span><span class="ansi38-220">[</span><span class="ansi38-220">to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2798"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">dfs</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2799"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2800"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2801"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2802"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2803"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2804">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3388/articulation-point-tarjan.cpp</span></span>
<span id="line-2805"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2806"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2807"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2808"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2809"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2810"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2811"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2812"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2813"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2814"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2815"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2816"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2817"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2818"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2819"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2820"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2821"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2822"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2823"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2824"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2825"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2826"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2827"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2828"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2829"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2830"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2831"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2832"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2833"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2834"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2835"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2836"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2837"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2838"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2839"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2840"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2841"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2842"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2843"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2844"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2845"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2846"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2847"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">,</span><span class="ansi38-220"> E </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2848"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> disc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2849"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> ap</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2850"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2851"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">fa</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2852"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">disc</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2853"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ccnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2854"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2855"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2856"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2857"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2858"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2859"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">fa </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;=</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2860"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                ap</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2861"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">fa</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2862"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">++</span><span class="ansi38-220">ccnt</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2863"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2864"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2865"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2866"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2867"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">fa </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> ccnt </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ap</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2868"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2869"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2870"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2871"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2872"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2873"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2874"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> y</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-2875"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">y</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2876"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2877"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2878"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2879"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">accumulate</span><span class="ansi38-220">(</span><span class="ansi38-220">ap </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> ap </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2880"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2881"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ap</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2882"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2883"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2884"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2885"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2886"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2887">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3390/matrix-exponentiation.cpp</span></span>
<span id="line-2888"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2889"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2890"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2891"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2892"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2893"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2894"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2895"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2896"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2897"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2898"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2899"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2900"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2901"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2902"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2903"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2904"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2905"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2906"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2907"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2908"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2909"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2910"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2911"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2912"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2913"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2914"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2915"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2916"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2917"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2918"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2919"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2920"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2921"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2922"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2923"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2924"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2925"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2926"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2927"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2928"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-2929"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2930"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">101</span><span class="ansi38-220">,</span><span class="ansi38-220"> mod </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1000000007</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2931"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2932"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">mat</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2933"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2934"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2935"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">mat</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">:</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2936"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2937"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2938"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2939"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2940"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    mat </span><span class="ansi38-198">&amp;</span><span class="ansi38-97">operator*=</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> mat </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2941"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> bb </span><span class="ansi38-198">=</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2942"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        mat </span><span class="ansi38-224">ret</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> bb</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2943"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2944"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> bb</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2945"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2946"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"></span></span>
<span id="line-2947"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                        </span><span class="ansi38-220">(</span><span class="ansi38-220">ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> mod</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2948"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        a </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2949"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2950"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ret</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2951"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">this</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2952"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2953"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2954"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2955"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2956"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2957"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2958"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    mat </span><span class="ansi38-224">a</span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">ans</span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2959"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2960"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2961"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> a</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> mod</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2962"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">*=</span><span class="ansi38-220"> a</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">*=</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2963"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2964"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">j</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">.</span><span class="ansi38-224">m</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">j</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2965"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2966"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2967"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2968"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2969"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2970"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2971">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3805/manacher.cpp</span></span>
<span id="line-2972"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-2973"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2974"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2975"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2976"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-2977"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2978"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2979"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2980"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2981"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2982"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2983"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2984"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2985"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2986"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2987"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2988"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2989"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2990"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2991"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-2992"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2993"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2994"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-2995"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-2996"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-2997"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-2998"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-2999"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3000"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3001"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3002"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3003"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3004"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3005"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3006"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3007"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3008"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3009"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3010"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3011"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3012"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3013"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3014"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">22000010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3015"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> tail </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3016"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">char</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3017"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3018"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">manacher</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3019"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> pos </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3020"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> tail</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3021"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">ext</span><span class="ansi38-220">[</span><span class="ansi38-220">(</span><span class="ansi38-220">pos </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">-</span><span class="ansi38-220"> i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3022"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">s</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">+</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3023"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">i </span><span class="ansi38-198">+</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">+</span><span class="ansi38-220"> ext</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> pos </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3024"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3025"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3026"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3027"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3028"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    s</span><span class="ansi38-220">[</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">/</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3029"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    s</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">.</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3030"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3031"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">islower</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3032"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3033"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">do</span><span class="ansi38-220"></span></span>
<span id="line-3034"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        s</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">tail</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">.</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3035"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-97">islower</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3036"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">manacher</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-198">*</span><span class="ansi38-224">max_element</span><span class="ansi38-220">(</span><span class="ansi38-220">ext </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> ext </span><span class="ansi38-198">+</span><span class="ansi38-220"> tail </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3037"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3038"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3039"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3040"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3041">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3806/tree-vertex-divide-and-conquer.cpp</span></span>
<span id="line-3042"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3043"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3044"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3045"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3046"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3047"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3048"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3049"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3050"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3051"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3052"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3053"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3054"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3055"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3056"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3057"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3058"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3059"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3060"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3061"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3062"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3063"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3064"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3065"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3066"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3067"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3068"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3069"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3070"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3071"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3072"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3073"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3074"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3075"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3076"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3077"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3078"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3079"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3080"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3081"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3082"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3083"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3084"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">10010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">101</span><span class="ansi38-220">,</span><span class="ansi38-220"> E </span><span class="ansi38-198">=</span><span class="ansi38-220"> N </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3085"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">E</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> tot</span><span class="ansi38-220">,</span><span class="ansi38-220"> rt</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3086"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    rtmsz </span><span class="ansi38-198">=</span><span class="ansi38-220"> N</span><span class="ansi38-220">,</span><span class="ansi38-220"> dcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> k</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdis</span><span class="ansi38-220">[</span><span class="ansi38-229">2</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3087"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> ans</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> f</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3088"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3089"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">grt</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">fa</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3090"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> msz </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3091"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3092"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3093"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3094"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa </span><span class="ansi38-198">||</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3095"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">grt</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> msz </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">msz</span><span class="ansi38-220">,</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+=</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3096"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3097"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    msz </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">msz</span><span class="ansi38-220">,</span><span class="ansi38-220"> tot </span><span class="ansi38-198">-</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3098"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">msz </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> rtmsz</span><span class="ansi38-220">)</span><span class="ansi38-220"> rtmsz </span><span class="ansi38-198">=</span><span class="ansi38-220"> msz</span><span class="ansi38-220">,</span><span class="ansi38-220"> rt </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3099"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3100"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3101"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">gdis</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">fa</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">d</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3102"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dis</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">dcnt</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> d</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3103"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3104"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3105"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> fa </span><span class="ansi38-198">||</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3106"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">gdis</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> d </span><span class="ansi38-198">+</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3107"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3108"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3109"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3110"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">gans</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">d</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3111"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">vdcnt </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3112"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3113"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        ans</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">|=</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-224">lower_bound</span><span class="ansi38-220">(</span><span class="ansi38-220">vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> vdcnt</span><span class="ansi38-220">,</span><span class="ansi38-220"> k</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> d</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"></span></span>
<span id="line-3114"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                  k</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> d</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3115"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3116"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3117"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">solve</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3118"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">vdcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3119"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3120"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3121"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3122"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        dcnt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">gdis</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">sort</span><span class="ansi38-220">(</span><span class="ansi38-220">dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> dcnt</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3123"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> dcnt</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">gans</span><span class="ansi38-220">(</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3124"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">merge</span><span class="ansi38-220">(</span><span class="ansi38-220">vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdis</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> vdcnt</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> dcnt</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3125"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">              vdis</span><span class="ansi38-220">[</span><span class="ansi38-198">!</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3126"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            f </span><span class="ansi38-198">^=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> vdcnt </span><span class="ansi38-198">+=</span><span class="ansi38-220"> dcnt</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3127"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3128"><span class="ansi38-145">  86</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3129"><span class="ansi38-145">  87</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3130"><span class="ansi38-145">  88</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3131"><span class="ansi38-145">  89</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        rt </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> rtmsz </span><span class="ansi38-198">=</span><span class="ansi38-220"> N</span><span class="ansi38-220">,</span><span class="ansi38-220"> tot </span><span class="ansi38-198">=</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> sz</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3132"><span class="ansi38-145">  90</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">grt</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">rt</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3133"><span class="ansi38-145">  91</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3134"><span class="ansi38-145">  92</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3135"><span class="ansi38-145">  93</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3136"><span class="ansi38-145">  94</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3137"><span class="ansi38-145">  95</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    tot </span><span class="ansi38-198">=</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3138"><span class="ansi38-145">  96</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3139"><span class="ansi38-145">  97</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3140"><span class="ansi38-145">  98</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        c</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> c</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">a</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3141"><span class="ansi38-145">  99</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">               to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">b</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3142"><span class="ansi38-145"> 100</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">               to</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3143"><span class="ansi38-145"> 101</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3144"><span class="ansi38-145"> 102</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> k</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3145"><span class="ansi38-145"> 103</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">grt</span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">solve</span><span class="ansi38-220">(</span><span class="ansi38-220">rt</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3146"><span class="ansi38-145"> 104</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-220">ans</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">AYE</span><span class="ansi38-152">"</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-152">"</span><span class="ansi38-152">NAY</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3147"><span class="ansi38-145"> 105</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3148"><span class="ansi38-145"> 106</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3149"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3150"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3151">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3807/lucas-theorem.cpp</span></span>
<span id="line-3152"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3153"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3154"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3155"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3156"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3157"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3158"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3159"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3160"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3161"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3162"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3163"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3164"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3165"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3166"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3167"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3168"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3169"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3170"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3171"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3172"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3173"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3174"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3175"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3176"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3177"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3178"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3179"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3180"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3181"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3182"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3183"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3184"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3185"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3186"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3187"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3188"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3189"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3190"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3191"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3192"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3193"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3194"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3195"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3196"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3197"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">getinv</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3198"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> p </span><span class="ansi38-198">/</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">getinv</span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">%</span><span class="ansi38-220"> x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3199"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3200"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3201"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">C</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">m</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3202"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3203"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">n</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">getinv</span><span class="ansi38-220">(</span><span class="ansi38-220">f</span><span class="ansi38-220">[</span><span class="ansi38-220">m</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">getinv</span><span class="ansi38-220">(</span><span class="ansi38-220">f</span><span class="ansi38-220">[</span><span class="ansi38-220">n </span><span class="ansi38-198">-</span><span class="ansi38-220"> m</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3204"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">C</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">C</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">/</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">/</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3205"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3206"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3207"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3208"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3209"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3210"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3211"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> f</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> i </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3212"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">inv </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> inv </span><span class="ansi38-198">+</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">C</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">+</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3213"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3214"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3215"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3216"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3217"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3218">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3811/modular-multiplicative-inverse-linear.cpp</span></span>
<span id="line-3219"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3220"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3221"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3222"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3223"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3224"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3225"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3226"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3227"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3228"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3229"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3230"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3231"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3232"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3233"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3234"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3235"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3236"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3237"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3238"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3239"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3240"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3241"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3242"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3243"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3244"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3245"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3246"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3247"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3248"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3249"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3250"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3251"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3252"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3253"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3254"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3255"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3256"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3257"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3258"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3259"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3260"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3261"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-229">20000529</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3262"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3263"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">getinv</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3264"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-220">x</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> p </span><span class="ansi38-198">/</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-224">getinv</span><span class="ansi38-220">(</span><span class="ansi38-220">p </span><span class="ansi38-198">%</span><span class="ansi38-220"> x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3265"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3266"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3267"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3268"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> p </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> inv</span><span class="ansi38-220">[</span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3269"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">getinv</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3270"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3271"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3272"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3273"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3274">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P3865/rmq-sparse-table.cpp</span></span>
<span id="line-3275"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3276"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3277"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3278"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3279"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3280"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3281"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3282"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3283"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3284"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3285"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3286"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3287"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3288"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3289"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3290"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3291"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3292"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3293"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3294"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3295"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3296"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3297"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3298"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3299"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3300"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3301"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3302"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3303"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3304"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3305"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3306"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3307"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3308"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3309"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3310"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3311"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3312"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3313"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3314"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3315"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3316"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3317"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3318"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">17</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> log2n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3319"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3320"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3321"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3322"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3323"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3324"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3325"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3326"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">stinit</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3327"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> log2n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">k</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3328"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3329"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3330"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3331"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3332"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">stqry</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">r</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3333"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> l </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3334"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-224">max</span><span class="ansi38-220">(</span><span class="ansi38-220">stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">l</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">r </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> k</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-220">k</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3335"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3336"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3337"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3338"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> log2n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">log2</span><span class="ansi38-220">(</span><span class="ansi38-220">n</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3339"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> stmx</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">[</span><span class="ansi38-229">0</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3340"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">stinit</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3341"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3342"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> l </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3343"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-224">stqry</span><span class="ansi38-220">(</span><span class="ansi38-220">l</span><span class="ansi38-220">,</span><span class="ansi38-220"> r</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3344"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3345"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3346"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3347"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3348"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3349">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4549/gcd-euclidean-iterative.cpp</span></span>
<span id="line-3350"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3351"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3352"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3353"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3354"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3355"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3356"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3357"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3358"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3359"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3360"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3361"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3362"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3363"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3364"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3365"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3366"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3367"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3368"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3369"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3370"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3371"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3372"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3373"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3374"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3375"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3376"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3377"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3378"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3379"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3380"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3381"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3382"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3383"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3384"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3385"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3386"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3387"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3388"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3389"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3390"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3391"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3392"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3393"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3394"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> r </span><span class="ansi38-198">=</span><span class="ansi38-220"> a </span><span class="ansi38-198">%</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> r</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3395"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3396"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3397"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3398"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3399"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3400"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">abs</span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3401"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3402"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3403"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3404"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3405"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3406">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4549/gcd-euclidean-recursive.cpp</span></span>
<span id="line-3407"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3408"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3409"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3410"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3411"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3412"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3413"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3414"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3415"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3416"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3417"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3418"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3419"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3420"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3421"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3422"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3423"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3424"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3425"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3426"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3427"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3428"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3429"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3430"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3431"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3432"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3433"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3434"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3435"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3436"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3437"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3438"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3439"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3440"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3441"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3442"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3443"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3444"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3445"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3446"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3447"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3448"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3449"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> b </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">%</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3450"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3451"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3452"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3453"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">abs</span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3454"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3455"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3456"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3457"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3458"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3459">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4549/gcd-stein-iterative.cpp</span></span>
<span id="line-3460"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3461"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3462"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3463"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3464"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3465"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3466"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3467"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3468"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3469"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3470"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3471"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3472"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3473"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3474"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3475"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3476"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3477"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3478"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3479"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3480"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3481"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3482"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3483"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3484"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3485"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3486"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3487"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3488"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3489"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3490"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3491"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3492"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3493"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3494"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3495"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3496"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3497"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3498"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3499"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3500"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3501"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3502"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3503"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> a </span><span class="ansi38-198">|</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3504"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> k </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3505"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">|</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> a </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">k</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3506"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> a </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3507"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">do</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3508"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">b </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> b </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3509"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">swap</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3510"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        b </span><span class="ansi38-198">-=</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3511"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"> </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3512"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> a </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3513"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3514"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3515"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3516"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3517"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">abs</span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3518"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3519"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3520"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3521"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3522"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3523">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4549/gcd-stein-recursive.cpp</span></span>
<span id="line-3524"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3525"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3526"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3527"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3528"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3529"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3530"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3531"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3532"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3533"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3534"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3535"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3536"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3537"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3538"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3539"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3540"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3541"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3542"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3543"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3544"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3545"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3546"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3547"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3548"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3549"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3550"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3551"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3552"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3553"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3554"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3555"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3556"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3557"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3558"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3559"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3560"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3561"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3562"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3563"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3564"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3565"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3566"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3567"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> a </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> b </span><span class="ansi38-198">?</span><span class="ansi38-220"> a </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> b </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> a </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> b </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">-</span><span class="ansi38-220"> b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">-</span><span class="ansi38-220"> a</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3568"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                  </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3569"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                          </span><span class="ansi38-198">:</span><span class="ansi38-220"> b </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">:</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">a </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">&gt;&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"></span></span>
<span id="line-3570"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                  </span><span class="ansi38-198">:</span><span class="ansi38-220"> a </span><span class="ansi38-198">|</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3571"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3572"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3573"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3574"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3575"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> __ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gcd</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">abs</span><span class="ansi38-220">(</span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3576"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">__</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3577"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3578"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3579"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3580"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3581">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4779/dijkstra-min-heap.cpp</span></span>
<span id="line-3582"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3583"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3584"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3585"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3586"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3587"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3588"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3589"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3590"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3591"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3592"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3593"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3594"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3595"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3596"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3597"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3598"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3599"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3600"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3601"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3602"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3603"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3604"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3605"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3606"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3607"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3608"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3609"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3610"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3611"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3612"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3613"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3614"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3615"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3616"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3617"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3618"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3619"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3620"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3621"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3622"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3623"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3624"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100010</span><span class="ansi38-220">,</span><span class="ansi38-220"> M </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">200010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3625"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> inf </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">100000000000</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3626"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">M</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> hsz </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3627"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3628"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">struct</span><span class="ansi38-220"> </span><span class="ansi38-220">hitm</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3629"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3630"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3631"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">bool</span><span class="ansi38-220"> </span><span class="ansi38-97">operator&lt;</span><span class="ansi38-220">(</span><span class="ansi38-198">const</span><span class="ansi38-220"> hitm </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">rhs</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"> </span><span class="ansi38-198">return</span><span class="ansi38-220"> d </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> rhs</span><span class="ansi38-220">.</span><span class="ansi38-224">d</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3632"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3633"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3634"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3635"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3636"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3637"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">dijkstra</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3638"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">fill</span><span class="ansi38-220">(</span><span class="ansi38-220">dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> inf</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">s</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> s</span><span class="ansi38-220">}</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3639"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                     </span><span class="ansi38-224">push_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3640"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">hsz</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3641"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-224">pop_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3642"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> u </span><span class="ansi38-198">=</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-220">]</span><span class="ansi38-220">.</span><span class="ansi38-224">u</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3643"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">continue</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3644"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3645"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3646"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3647"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> ndis </span><span class="ansi38-198">=</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3648"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ndis </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3649"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                dis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> ndis</span><span class="ansi38-220">,</span><span class="ansi38-220"> h</span><span class="ansi38-220">[</span><span class="ansi38-220">hsz</span><span class="ansi38-198">++</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220">ndis</span><span class="ansi38-220">,</span><span class="ansi38-220"> v</span><span class="ansi38-220">}</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">push_heap</span><span class="ansi38-220">(</span><span class="ansi38-220">h</span><span class="ansi38-220">,</span><span class="ansi38-220"> h </span><span class="ansi38-198">+</span><span class="ansi38-220"> hsz</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3650"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3651"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3652"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3653"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3654"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3655"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> s </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3656"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3657"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3658"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">f</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> i</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> w</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3659"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3660"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">dijkstra</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3661"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">dis</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3662"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3663"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3664"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3665"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3666"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3667">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P4782/2-sat-tarjan.cpp</span></span>
<span id="line-3668"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3669"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3670"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3671"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3672"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3673"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3674"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3675"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3676"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3677"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3678"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3679"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3680"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3681"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3682"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3683"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3684"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3685"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3686"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3687"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3688"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3689"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3690"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3691"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3692"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3693"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3694"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3695"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3696"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3697"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3698"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3699"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3700"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3701"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3702"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3703"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3704"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3705"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3706"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3707"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3708"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3709"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3710"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">const</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> N </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2000010</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3711"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> n</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> disc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> top </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3712"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                                               ord</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> scc </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3713"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">bool</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> ans</span><span class="ansi38-220">[</span><span class="ansi38-220">N</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3714"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3715"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3716"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">disc</span><span class="ansi38-220">,</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-198">++</span><span class="ansi38-220">top</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> u</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3717"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"> e</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3718"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e</span><span class="ansi38-220">]</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3719"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3720"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">v</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3721"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3722"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">min</span><span class="ansi38-220">(</span><span class="ansi38-220">low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3723"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3724"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> low</span><span class="ansi38-220">[</span><span class="ansi38-220">u</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3725"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">++</span><span class="ansi38-220">scc</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3726"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> v </span><span class="ansi38-198">=</span><span class="ansi38-220"> stk</span><span class="ansi38-220">[</span><span class="ansi38-220">top</span><span class="ansi38-198">--</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3727"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            ord</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> scc</span><span class="ansi38-220">,</span><span class="ansi38-220"> vis</span><span class="ansi38-220">[</span><span class="ansi38-220">v</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3728"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">v </span><span class="ansi38-198">==</span><span class="ansi38-220"> u</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">break</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3729"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3730"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3731"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3732"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3733"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3734"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3735"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> e </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> e </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> m</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">e</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3736"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> j </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3737"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> x1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">^</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"> x2 </span><span class="ansi38-198">=</span><span class="ansi38-220"> j </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">^</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3738"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x1 </span><span class="ansi38-198">^</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x1 </span><span class="ansi38-198">^</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> to</span><span class="ansi38-220">[</span><span class="ansi38-220">e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x2</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3739"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                e1</span><span class="ansi38-220">[</span><span class="ansi38-220">e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x2 </span><span class="ansi38-198">^</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">,</span><span class="ansi38-220"> e0</span><span class="ansi38-220">[</span><span class="ansi38-220">x2 </span><span class="ansi38-198">^</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3740"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                to</span><span class="ansi38-220">[</span><span class="ansi38-220">e </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">=</span><span class="ansi38-220"> x1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3741"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3742"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3743"><span class="ansi38-145">  75</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">dfn</span><span class="ansi38-220">[</span><span class="ansi38-220">i</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">tarjan</span><span class="ansi38-220">(</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3744"><span class="ansi38-145">  76</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3745"><span class="ansi38-145">  77</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ord</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">==</span><span class="ansi38-220"> ord</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3746"><span class="ansi38-145">  78</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">IMPOSSIBLE</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3747"><span class="ansi38-145">  79</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3748"><span class="ansi38-145">  80</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3749"><span class="ansi38-145">  81</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">POSSIBLE</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3750"><span class="ansi38-145">  82</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">ord</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">|</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220"> </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> ord</span><span class="ansi38-220">[</span><span class="ansi38-220">i </span><span class="ansi38-198">&lt;&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">]</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3751"><span class="ansi38-145">  83</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3752"><span class="ansi38-145">  84</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3753"><span class="ansi38-145">  85</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3754"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3755"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3756">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P5091/extended-euler-theorem.cpp</span></span>
<span id="line-3757"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3758"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3759"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3760"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3761"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3762"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3763"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3764"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3765"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3766"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3767"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3768"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3769"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3770"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3771"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3772"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3773"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3774"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3775"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3776"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3777"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3778"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3779"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3780"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3781"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3782"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3783"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3784"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3785"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3786"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3787"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3788"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3789"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3790"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3791"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3792"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3793"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3794"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3795"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3796"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3797"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3798"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3799"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">mgu</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3800"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3801"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3802"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3803"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3804"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3805"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> p </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%=</span><span class="ansi38-220"> p</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3806"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> x </span><span class="ansi38-198">+</span><span class="ansi38-220"> p </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3807"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3808"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3809"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">phi</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3810"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3811"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> i </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">2</span><span class="ansi38-220">;</span><span class="ansi38-220"> i </span><span class="ansi38-198">*</span><span class="ansi38-220"> i </span><span class="ansi38-198">&lt;=</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-198">++</span><span class="ansi38-220">i</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3812"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">%</span><span class="ansi38-220"> i</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3813"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            ans </span><span class="ansi38-198">-=</span><span class="ansi38-220"> ans </span><span class="ansi38-198">/</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3814"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">%</span><span class="ansi38-220"> i</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> n </span><span class="ansi38-198">/=</span><span class="ansi38-220"> i</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3815"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3816"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">n </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> ans </span><span class="ansi38-198">-=</span><span class="ansi38-220"> ans </span><span class="ansi38-198">/</span><span class="ansi38-220"> n</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3817"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3818"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3819"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3820"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">n</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">k</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">p</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3821"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3822"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">;</span><span class="ansi38-220"> k</span><span class="ansi38-220">;</span><span class="ansi38-220"> k </span><span class="ansi38-198">&gt;&gt;=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> k </span><span class="ansi38-198">&amp;</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">ans </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> ans </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> n </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1LL</span><span class="ansi38-220"> </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">*</span><span class="ansi38-220"> n </span><span class="ansi38-198">%</span><span class="ansi38-220"> p</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3823"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> ans</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3824"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3825"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3826"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3827"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> m </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">mgu</span><span class="ansi38-220">(</span><span class="ansi38-224">phi</span><span class="ansi38-220">(</span><span class="ansi38-220">m</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3828"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    a </span><span class="ansi38-198">%=</span><span class="ansi38-220"> m</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-97">pow</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> m</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3829"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3830"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3831"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3832"><span class="ansi38-145">───────┬────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3833">       <span class="ansi38-145">│ </span>File: <span class="ansi1">P5656/extended-euclidean.cpp</span></span>
<span id="line-3834"><span class="ansi38-145">───────┼────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3835"><span class="ansi38-145">   1</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">#include</span><span class="ansi38-220"> </span><span class="ansi38-152">&lt;</span><span class="ansi38-152">bits/stdc++.h</span><span class="ansi38-152">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3836"><span class="ansi38-145">   2</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">using</span><span class="ansi38-220"> </span><span class="ansi38-198">namespace</span><span class="ansi38-220"> std</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3837"><span class="ansi38-145">   3</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3838"><span class="ansi38-145">   4</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">{{{</span></span>
<span id="line-3839"><span class="ansi38-145">   5</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3840"><span class="ansi38-145">   6</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3841"><span class="ansi38-145">   7</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3842"><span class="ansi38-145">   8</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3843"><span class="ansi38-145">   9</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3844"><span class="ansi38-145">  10</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3845"><span class="ansi38-145">  11</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3846"><span class="ansi38-145">  12</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3847"><span class="ansi38-145">  13</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3848"><span class="ansi38-145">  14</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-97">gll</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3849"><span class="ansi38-145">  15</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3850"><span class="ansi38-145">  16</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3851"><span class="ansi38-145">  17</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">char</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3852"><span class="ansi38-145">  18</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220"> c </span><span class="ansi38-198">==</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">f </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3853"><span class="ansi38-145">  19</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">for</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">=</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">;</span><span class="ansi38-220"> </span><span class="ansi38-97">isdigit</span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-97">getchar</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> x </span><span class="ansi38-198">*</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> c </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3854"><span class="ansi38-145">  20</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3855"><span class="ansi38-145">  21</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> f </span><span class="ansi38-198">?</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x </span><span class="ansi38-198">:</span><span class="ansi38-220"> x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3856"><span class="ansi38-145">  22</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3857"><span class="ansi38-145">  23</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3858"><span class="ansi38-145">  24</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3859"><span class="ansi38-145">  25</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3860"><span class="ansi38-145">  26</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&lt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152">-</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-198">-</span><span class="ansi38-220">x</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3861"><span class="ansi38-145">  27</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">9</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">/</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3862"><span class="ansi38-145">  28</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">%</span><span class="ansi38-220"> </span><span class="ansi38-229">10</span><span class="ansi38-220"> </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-152">'</span><span class="ansi38-152">0</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3863"><span class="ansi38-145">  29</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3864"><span class="ansi38-145">  30</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3865"><span class="ansi38-145">  31</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3866"><span class="ansi38-145">  32</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3867"><span class="ansi38-145">  33</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-152"> </span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3868"><span class="ansi38-145">  34</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3869"><span class="ansi38-145">  35</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3870"><span class="ansi38-145">  36</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">template</span><span class="ansi38-220"> </span><span class="ansi38-220">&lt;</span><span class="ansi38-198">typename</span><span class="ansi38-220"> T</span><span class="ansi38-220">&gt;</span><span class="ansi38-220"></span></span>
<span id="line-3871"><span class="ansi38-145">  37</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">inline</span><span class="ansi38-220"> </span><span class="ansi38-198">void</span><span class="ansi38-220"> </span><span class="ansi38-97">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">T </span><span class="ansi38-224">x</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3872"><span class="ansi38-145">  38</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-224">puti</span><span class="ansi38-220">(</span><span class="ansi38-220">x</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-97">putchar</span><span class="ansi38-220">(</span><span class="ansi38-152">'</span><span class="ansi38-86">\n</span><span class="ansi38-152">'</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3873"><span class="ansi38-145">  39</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3874"><span class="ansi38-145">  40</span>   <span class="ansi38-145">│</span> <span class="ansi38-92">//</span><span class="ansi38-92">}}}</span></span>
<span id="line-3875"><span class="ansi38-145">  41</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3876"><span class="ansi38-145">  42</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-224">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">x</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;</span><span class="ansi38-224">y</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3877"><span class="ansi38-145">  43</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-198">!</span><span class="ansi38-220">b</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3878"><span class="ansi38-145">  44</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        x </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3879"><span class="ansi38-145">  45</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">return</span><span class="ansi38-220"> a</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3880"><span class="ansi38-145">  46</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3881"><span class="ansi38-145">  47</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3882"><span class="ansi38-145">  48</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-220">b</span><span class="ansi38-220">,</span><span class="ansi38-220"> a </span><span class="ansi38-198">%</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> x0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y0</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3883"><span class="ansi38-145">  49</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    x </span><span class="ansi38-198">=</span><span class="ansi38-220"> y0</span><span class="ansi38-220">,</span><span class="ansi38-220"> y </span><span class="ansi38-198">=</span><span class="ansi38-220"> x0 </span><span class="ansi38-198">-</span><span class="ansi38-220"> a </span><span class="ansi38-198">/</span><span class="ansi38-220"> b </span><span class="ansi38-198">*</span><span class="ansi38-220"> y0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3884"><span class="ansi38-145">  50</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> c</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3885"><span class="ansi38-145">  51</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3886"><span class="ansi38-145">  52</span>   <span class="ansi38-145">│</span> <span class="ansi38-220"></span></span>
<span id="line-3887"><span class="ansi38-145">  53</span>   <span class="ansi38-145">│</span> <span class="ansi38-198">int</span><span class="ansi38-220"> </span><span class="ansi38-97">main</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3888"><span class="ansi38-145">  54</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">int</span><span class="ansi38-220"> _ </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3889"><span class="ansi38-145">  55</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">while</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">_</span><span class="ansi38-198">--</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3890"><span class="ansi38-145">  56</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> a </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> c </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">gi</span><span class="ansi38-220">(</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3891"><span class="ansi38-145">  57</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3892"><span class="ansi38-145">  58</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">int</span><span class="ansi38-220"> d </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-224">exgcd</span><span class="ansi38-220">(</span><span class="ansi38-220">a</span><span class="ansi38-220">,</span><span class="ansi38-220"> b</span><span class="ansi38-220">,</span><span class="ansi38-220"> x</span><span class="ansi38-220">,</span><span class="ansi38-220"> y</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3893"><span class="ansi38-145">  59</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">%</span><span class="ansi38-220"> d</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3894"><span class="ansi38-145">  60</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-97">puts</span><span class="ansi38-220">(</span><span class="ansi38-152">"</span><span class="ansi38-152">-1</span><span class="ansi38-152">"</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3895"><span class="ansi38-145">  61</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-198">else</span><span class="ansi38-220"> </span><span class="ansi38-220">{</span><span class="ansi38-220"></span></span>
<span id="line-3896"><span class="ansi38-145">  62</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            a </span><span class="ansi38-198">/=</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> b </span><span class="ansi38-198">/=</span><span class="ansi38-220"> d</span><span class="ansi38-220">,</span><span class="ansi38-220"> c </span><span class="ansi38-198">/=</span><span class="ansi38-220"> d</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3897"><span class="ansi38-145">  63</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">long</span><span class="ansi38-220"> </span><span class="ansi38-198">long</span><span class="ansi38-220"> x0 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x </span><span class="ansi38-198">*</span><span class="ansi38-220"> c </span><span class="ansi38-198">%</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> b </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3898"><span class="ansi38-145">  64</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                      y0 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">y </span><span class="ansi38-198">*</span><span class="ansi38-220"> c </span><span class="ansi38-198">%</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> a </span><span class="ansi38-198">-</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">%</span><span class="ansi38-220"> a </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">,</span><span class="ansi38-220"> x1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">-</span><span class="ansi38-220"> b </span><span class="ansi38-198">*</span><span class="ansi38-220"> y0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">/</span><span class="ansi38-220"> a</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3899"><span class="ansi38-145">  65</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                      y1 </span><span class="ansi38-198">=</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">c </span><span class="ansi38-198">-</span><span class="ansi38-220"> a </span><span class="ansi38-198">*</span><span class="ansi38-220"> x0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">/</span><span class="ansi38-220"> b</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3900"><span class="ansi38-145">  66</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">if</span><span class="ansi38-220"> </span><span class="ansi38-220">(</span><span class="ansi38-220">x1 </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220"> </span><span class="ansi38-198">&amp;&amp;</span><span class="ansi38-220"> y1 </span><span class="ansi38-198">&gt;</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">)</span><span class="ansi38-220"></span></span>
<span id="line-3901"><span class="ansi38-145">  67</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">(</span><span class="ansi38-220">x1 </span><span class="ansi38-198">-</span><span class="ansi38-220"> x0</span><span class="ansi38-220">)</span><span class="ansi38-220"> </span><span class="ansi38-198">/</span><span class="ansi38-220"> b </span><span class="ansi38-198">+</span><span class="ansi38-220"> </span><span class="ansi38-229">1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">x0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">y0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">x1</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"></span></span>
<span id="line-3902"><span class="ansi38-145">  68</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                    </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">y1</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3903"><span class="ansi38-145">  69</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">            </span><span class="ansi38-198">else</span><span class="ansi38-220"></span></span>
<span id="line-3904"><span class="ansi38-145">  70</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">                </span><span class="ansi38-224">putsp</span><span class="ansi38-220">(</span><span class="ansi38-220">x0</span><span class="ansi38-220">)</span><span class="ansi38-220">,</span><span class="ansi38-220"> </span><span class="ansi38-224">putln</span><span class="ansi38-220">(</span><span class="ansi38-220">y0</span><span class="ansi38-220">)</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3905"><span class="ansi38-145">  71</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">        </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3906"><span class="ansi38-145">  72</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3907"><span class="ansi38-145">  73</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">    </span><span class="ansi38-198">return</span><span class="ansi38-220"> </span><span class="ansi38-229">0</span><span class="ansi38-220">;</span><span class="ansi38-220"></span></span>
<span id="line-3908"><span class="ansi38-145">  74</span>   <span class="ansi38-145">│</span> <span class="ansi38-220">}</span><span class="ansi38-220"></span></span>
<span id="line-3909"><span class="ansi38-145">───────┴────────────────────────────────────────────────────────────────────────</span></span>
<span id="line-3910"></span>

</pre>
</body>

</html>
